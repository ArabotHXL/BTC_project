{% extends "base.html" %}

{% block title %}Edge Collector 部署手册 | Deployment Manual{% endblock %}

{% block head %}
<style>
    .manual-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 2rem;
    }
    
    .section-card {
        background: rgba(33, 37, 41, 0.95);
        border: 1px solid rgba(247, 147, 26, 0.2);
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .section-title {
        color: #f7931a;
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .code-block {
        background: #1a1d2e;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 1rem;
        font-family: 'Monaco', 'Consolas', monospace;
        font-size: 0.9rem;
        overflow-x: auto;
        margin: 1rem 0;
        position: relative;
    }
    
    .code-block pre {
        margin: 0;
        color: #e0e0e0;
    }
    
    .copy-btn {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background: rgba(247, 147, 26, 0.2);
        border: 1px solid #f7931a;
        color: #f7931a;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.75rem;
    }
    
    .copy-btn:hover {
        background: rgba(247, 147, 26, 0.4);
    }
    
    .step-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        background: #f7931a;
        color: #000;
        border-radius: 50%;
        font-weight: bold;
        margin-right: 0.75rem;
    }
    
    .step-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: rgba(0,0,0,0.2);
        border-radius: 8px;
    }
    
    .step-content {
        flex: 1;
    }
    
    .step-content h4 {
        margin: 0 0 0.5rem 0;
        color: #fff;
    }
    
    .step-content p {
        margin: 0;
        color: #aaa;
    }
    
    .data-table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
    }
    
    .data-table th,
    .data-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid #333;
    }
    
    .data-table th {
        background: rgba(247, 147, 26, 0.1);
        color: #f7931a;
    }
    
    .data-table tr:hover {
        background: rgba(255,255,255,0.02);
    }
    
    .architecture-diagram {
        background: #1a1d2e;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 1.5rem;
        font-family: monospace;
        font-size: 0.85rem;
        line-height: 1.4;
        overflow-x: auto;
        color: #00ff88;
    }
    
    .badge-success {
        background: rgba(40, 167, 69, 0.2);
        color: #28a745;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.8rem;
    }
    
    .badge-warning {
        background: rgba(255, 193, 7, 0.2);
        color: #ffc107;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.8rem;
    }
    
    .download-card {
        background: linear-gradient(135deg, rgba(247, 147, 26, 0.1), rgba(247, 147, 26, 0.05));
        border: 2px solid #f7931a;
        border-radius: 12px;
        padding: 2rem;
        text-align: center;
        margin: 2rem 0;
    }
    
    .download-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background: #f7931a;
        color: #000;
        padding: 1rem 2rem;
        border-radius: 8px;
        font-weight: bold;
        text-decoration: none;
        transition: all 0.3s;
    }
    
    .download-btn:hover {
        background: #ff9f00;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(247, 147, 26, 0.4);
    }
    
    .toc {
        background: rgba(0,0,0,0.3);
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .toc-title {
        color: #f7931a;
        margin-bottom: 1rem;
        font-size: 1.1rem;
    }
    
    .toc-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .toc-list li {
        margin-bottom: 0.5rem;
    }
    
    .toc-list a {
        color: #8ab4f8;
        text-decoration: none;
    }
    
    .toc-list a:hover {
        color: #f7931a;
    }
    
    .lang-toggle {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .lang-btn {
        padding: 0.5rem 1rem;
        border: 1px solid #f7931a;
        background: transparent;
        color: #f7931a;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .lang-btn.active {
        background: #f7931a;
        color: #000;
    }
    
    .zh { display: block; }
    .en { display: none; }
    
    body.lang-en .zh { display: none; }
    body.lang-en .en { display: block; }
    
    .alert-box {
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .alert-warning {
        background: rgba(255, 193, 7, 0.1);
        border: 1px solid rgba(255, 193, 7, 0.3);
        color: #ffc107;
    }
    
    .alert-info {
        background: rgba(13, 202, 240, 0.1);
        border: 1px solid rgba(13, 202, 240, 0.3);
        color: #0dcaf0;
    }
    
    .alert-success {
        background: rgba(40, 167, 69, 0.1);
        border: 1px solid rgba(40, 167, 69, 0.3);
        color: #28a745;
    }
</style>
{% endblock %}

{% block content %}
<div class="manual-container">
    <!-- Header -->
    <div class="text-center mb-4">
        <h1 style="color: #f7931a;">
            <i class="fas fa-satellite-dish me-2"></i>
            <span class="zh">Edge Collector 部署手册</span>
            <span class="en">Edge Collector Deployment Manual</span>
        </h1>
        <p class="text-muted">
            <span class="zh">矿场边缘数据采集器 - 完整部署指南 v1.0</span>
            <span class="en">Mining Farm Edge Data Collector - Complete Deployment Guide v1.0</span>
        </p>
        
        <!-- Language Toggle -->
        <div class="lang-toggle justify-content-center">
            <button class="lang-btn active" onclick="setLang('zh')">中文</button>
            <button class="lang-btn" onclick="setLang('en')">English</button>
        </div>
    </div>
    
    <!-- Table of Contents -->
    <div class="toc">
        <div class="toc-title">
            <i class="fas fa-list me-2"></i>
            <span class="zh">目录</span>
            <span class="en">Table of Contents</span>
        </div>
        <ul class="toc-list">
            <li><a href="#overview"><span class="zh">1. 系统概述</span><span class="en">1. System Overview</span></a></li>
            <li><a href="#requirements"><span class="zh">2. 系统要求</span><span class="en">2. System Requirements</span></a></li>
            <li><a href="#installation"><span class="zh">3. 安装步骤</span><span class="en">3. Installation Steps</span></a></li>
            <li><a href="#configuration"><span class="zh">4. 配置说明</span><span class="en">4. Configuration</span></a></li>
            <li><a href="#apikey"><span class="zh">5. 获取API密钥</span><span class="en">5. Get API Key</span></a></li>
            <li><a href="#testing"><span class="zh">6. 测试连接</span><span class="en">6. Test Connection</span></a></li>
            <li><a href="#production"><span class="zh">7. 生产部署</span><span class="en">7. Production Deployment</span></a></li>
            <li><a href="#troubleshooting"><span class="zh">8. 故障排查</span><span class="en">8. Troubleshooting</span></a></li>
            <li><a href="#data"><span class="zh">9. 采集数据说明</span><span class="en">9. Collected Data</span></a></li>
        </ul>
    </div>
    
    <!-- Download Section -->
    <div class="download-card">
        <h3 style="color: #f7931a; margin-bottom: 1rem;">
            <i class="fas fa-download me-2"></i>
            <span class="zh">下载部署包</span>
            <span class="en">Download Deployment Package</span>
        </h3>
        <p class="text-muted mb-3">
            <span class="zh">包含所有必需文件和配置模板</span>
            <span class="en">Includes all required files and configuration templates</span>
        </p>
        <a href="/api/collector/download-package" class="download-btn">
            <i class="fas fa-file-archive"></i>
            <span class="zh">下载 edge_collector.zip</span>
            <span class="en">Download edge_collector.zip</span>
        </a>
    </div>
    
    <!-- Section 1: Overview -->
    <div class="section-card" id="overview">
        <h2 class="section-title">
            <i class="fas fa-info-circle"></i>
            <span class="zh">1. 系统概述</span>
            <span class="en">1. System Overview</span>
        </h2>
        
        <p class="zh">Edge Collector 是部署在矿场本地的数据采集程序，通过 CGMiner API (端口4028) 实时采集矿机运行数据，并上传到 HashInsight 云端平台。</p>
        <p class="en">Edge Collector is a data collection program deployed locally at mining farms. It collects real-time miner data via CGMiner API (port 4028) and uploads to HashInsight cloud platform.</p>
        
        <div class="architecture-diagram">
<pre>
矿场内网 Mining Farm LAN              云端 Cloud (HashInsight)
┌─────────────────────────────┐      ┌─────────────────────────────┐
│                             │      │                             │
│  ┌─────┐ ┌─────┐ ┌─────┐   │      │  ┌─────────────────────┐   │
│  │Miner│ │Miner│ │Miner│   │      │  │  /api/collector/    │   │
│  │ S19 │ │ S21 │ │ M30 │   │      │  │  upload             │   │
│  └──┬──┘ └──┬──┘ └──┬──┘   │      │  └──────────┬──────────┘   │
│     │       │       │       │      │             │              │
│     └───────┼───────┘       │      │             ▼              │
│             │ TCP 4028      │      │  ┌─────────────────────┐   │
│             ▼               │      │  │  PostgreSQL         │   │
│  ┌─────────────────────┐   │      │  │  + Redis Cache      │   │
│  │   Edge Collector    │───┼──────┼──│                     │   │
│  │   (Python Script)   │   │ HTTPS│  │  Real-time Dashboard│   │
│  └─────────────────────┘   │      │  └─────────────────────┘   │
│                             │      │                             │
└─────────────────────────────┘      └─────────────────────────────┘
</pre>
        </div>
        
        <h4 class="mt-4" style="color: #fff;">
            <span class="zh">功能特性</span>
            <span class="en">Features</span>
        </h4>
        <ul style="color: #aaa;">
            <li class="zh">✅ 支持 Antminer S19/S21/T19 系列</li>
            <li class="en">✅ Supports Antminer S19/S21/T19 series</li>
            <li class="zh">✅ 支持 Whatsminer M30/M50 系列</li>
            <li class="en">✅ Supports Whatsminer M30/M50 series</li>
            <li class="zh">✅ 批量采集 6000+ 矿机 (50-150并发)</li>
            <li class="en">✅ Batch collection for 6000+ miners (50-150 concurrent)</li>
            <li class="zh">✅ 数据 gzip 压缩传输</li>
            <li class="en">✅ Gzip compressed data transmission</li>
            <li class="zh">✅ 断网自动缓存，恢复后重传</li>
            <li class="en">✅ Automatic offline caching, retransmit on recovery</li>
            <li class="zh">✅ 端到端加密 (可选)</li>
            <li class="en">✅ End-to-end encryption (optional)</li>
        </ul>
    </div>
    
    <!-- Section 2: Requirements -->
    <div class="section-card" id="requirements">
        <h2 class="section-title">
            <i class="fas fa-server"></i>
            <span class="zh">2. 系统要求</span>
            <span class="en">2. System Requirements</span>
        </h2>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th><span class="zh">项目</span><span class="en">Item</span></th>
                    <th><span class="zh">最低要求</span><span class="en">Minimum</span></th>
                    <th><span class="zh">推荐配置</span><span class="en">Recommended</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="zh">操作系统</span><span class="en">OS</span></td>
                    <td>Ubuntu 18.04 / CentOS 7</td>
                    <td>Ubuntu 22.04 / Debian 11</td>
                </tr>
                <tr>
                    <td>Python</td>
                    <td>3.8+</td>
                    <td>3.10+</td>
                </tr>
                <tr>
                    <td><span class="zh">内存</span><span class="en">RAM</span></td>
                    <td>512MB</td>
                    <td>2GB</td>
                </tr>
                <tr>
                    <td><span class="zh">磁盘</span><span class="en">Disk</span></td>
                    <td>100MB</td>
                    <td>1GB (for cache)</td>
                </tr>
                <tr>
                    <td><span class="zh">网络</span><span class="en">Network</span></td>
                    <td colspan="2"><span class="zh">可访问矿机4028端口 + 可访问互联网HTTPS</span><span class="en">Access to miners port 4028 + Internet HTTPS access</span></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- Section 3: Installation -->
    <div class="section-card" id="installation">
        <h2 class="section-title">
            <i class="fas fa-download"></i>
            <span class="zh">3. 安装步骤</span>
            <span class="en">3. Installation Steps</span>
        </h2>
        
        <div class="step-item">
            <span class="step-number">1</span>
            <div class="step-content">
                <h4><span class="zh">下载部署包</span><span class="en">Download Package</span></h4>
                <p class="zh">从上方下载按钮获取 edge_collector.zip</p>
                <p class="en">Download edge_collector.zip from the button above</p>
            </div>
        </div>
        
        <div class="step-item">
            <span class="step-number">2</span>
            <div class="step-content">
                <h4><span class="zh">解压并安装依赖</span><span class="en">Extract and Install Dependencies</span></h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># 解压
unzip edge_collector.zip
cd edge_collector

# 安装依赖
pip3 install requests</pre>
                </div>
            </div>
        </div>
        
        <div class="step-item">
            <span class="step-number">3</span>
            <div class="step-content">
                <h4><span class="zh">创建配置文件</span><span class="en">Create Configuration</span></h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># 初始化配置
python3 cgminer_collector.py --init</pre>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Section 4: Configuration -->
    <div class="section-card" id="configuration">
        <h2 class="section-title">
            <i class="fas fa-cog"></i>
            <span class="zh">4. 配置说明</span>
            <span class="en">4. Configuration</span>
        </h2>
        
        <p class="zh">编辑 <code>collector_config.json</code> 文件：</p>
        <p class="en">Edit <code>collector_config.json</code> file:</p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>{
    "api_url": "https://calc.hashinsight.net",
    "api_key": "hsc_your_api_key_here",
    "site_id": "site_001",
    "collection_interval": 30,
    "max_workers": 50,
    "miners": [
        {"id": "S19_0001", "ip": "192.168.1.100", "type": "antminer"},
        {"id": "S19_0002", "ip": "192.168.1.101", "type": "antminer"}
    ],
    "ip_ranges": [
        {
            "range": "192.168.1.100-192.168.1.199",
            "prefix": "S19_",
            "type": "antminer"
        },
        {
            "range": "192.168.2.100-192.168.2.199",
            "prefix": "M30_",
            "type": "whatsminer"
        }
    ]
}</pre>
        </div>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th><span class="zh">参数</span><span class="en">Parameter</span></th>
                    <th><span class="zh">说明</span><span class="en">Description</span></th>
                    <th><span class="zh">默认值</span><span class="en">Default</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>api_url</code></td>
                    <td><span class="zh">HashInsight云端地址</span><span class="en">HashInsight cloud URL</span></td>
                    <td><span class="badge-warning">必填 Required</span></td>
                </tr>
                <tr>
                    <td><code>api_key</code></td>
                    <td><span class="zh">采集器API密钥</span><span class="en">Collector API key</span></td>
                    <td><span class="badge-warning">必填 Required</span></td>
                </tr>
                <tr>
                    <td><code>site_id</code></td>
                    <td><span class="zh">矿场站点ID</span><span class="en">Mining site ID</span></td>
                    <td><span class="badge-warning">必填 Required</span></td>
                </tr>
                <tr>
                    <td><code>collection_interval</code></td>
                    <td><span class="zh">采集间隔(秒)</span><span class="en">Collection interval (seconds)</span></td>
                    <td>30</td>
                </tr>
                <tr>
                    <td><code>max_workers</code></td>
                    <td><span class="zh">并发采集数</span><span class="en">Concurrent workers</span></td>
                    <td>50</td>
                </tr>
                <tr>
                    <td><code>miners</code></td>
                    <td><span class="zh">矿机列表(手动)</span><span class="en">Miner list (manual)</span></td>
                    <td>[]</td>
                </tr>
                <tr>
                    <td><code>ip_ranges</code></td>
                    <td><span class="zh">IP范围批量生成</span><span class="en">IP range batch generation</span></td>
                    <td>[]</td>
                </tr>
            </tbody>
        </table>
        
        <div class="alert-box alert-info mt-3">
            <i class="fas fa-lightbulb me-2"></i>
            <span class="zh"><strong>提示：</strong>使用 <code>ip_ranges</code> 可以自动生成大量矿机配置，无需逐个填写 <code>miners</code></span>
            <span class="en"><strong>Tip:</strong> Use <code>ip_ranges</code> to auto-generate miner configs, no need to fill <code>miners</code> individually</span>
        </div>
    </div>
    
    <!-- Section 5: API Key -->
    <div class="section-card" id="apikey">
        <h2 class="section-title">
            <i class="fas fa-key"></i>
            <span class="zh">5. 获取API密钥</span>
            <span class="en">5. Get API Key</span>
        </h2>
        
        <div class="step-item">
            <span class="step-number">1</span>
            <div class="step-content">
                <h4><span class="zh">登录 HashInsight 平台</span><span class="en">Login to HashInsight Platform</span></h4>
                <p><code>https://calc.hashinsight.net</code></p>
            </div>
        </div>
        
        <div class="step-item">
            <span class="step-number">2</span>
            <div class="step-content">
                <h4><span class="zh">进入托管管理 → 站点管理</span><span class="en">Go to Hosting → Site Management</span></h4>
            </div>
        </div>
        
        <div class="step-item">
            <span class="step-number">3</span>
            <div class="step-content">
                <h4><span class="zh">选择站点 → 采集器设置</span><span class="en">Select Site → Collector Settings</span></h4>
            </div>
        </div>
        
        <div class="step-item">
            <span class="step-number">4</span>
            <div class="step-content">
                <h4><span class="zh">点击 "生成新密钥"</span><span class="en">Click "Generate New Key"</span></h4>
                <p class="zh">复制生成的密钥到配置文件的 <code>api_key</code> 字段</p>
                <p class="en">Copy the generated key to <code>api_key</code> field in config</p>
            </div>
        </div>
        
        <div class="alert-box alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span class="zh"><strong>安全提示：</strong>API密钥应妥善保管，不要分享给未授权人员</span>
            <span class="en"><strong>Security:</strong> Keep your API key safe, do not share with unauthorized personnel</span>
        </div>
    </div>
    
    <!-- Section 6: Testing -->
    <div class="section-card" id="testing">
        <h2 class="section-title">
            <i class="fas fa-flask"></i>
            <span class="zh">6. 测试连接</span>
            <span class="en">6. Test Connection</span>
        </h2>
        
        <h4><span class="zh">测试单个矿机</span><span class="en">Test Single Miner</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>python3 cgminer_collector.py --test 192.168.1.100</pre>
        </div>
        
        <h4 class="mt-3"><span class="zh">单次采集测试</span><span class="en">Single Collection Test</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>python3 cgminer_collector.py --once</pre>
        </div>
        
        <h4 class="mt-3"><span class="zh">验证云端连接</span><span class="en">Verify Cloud Connection</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>curl -H "X-API-Key: hsc_your_key" https://calc.hashinsight.net/api/collector/status</pre>
        </div>
        
        <div class="alert-box alert-success">
            <i class="fas fa-check-circle me-2"></i>
            <span class="zh">如果返回 <code>{"status": "ok"}</code>，说明连接正常</span>
            <span class="en">If returns <code>{"status": "ok"}</code>, connection is working</span>
        </div>
    </div>
    
    <!-- Section 7: Production -->
    <div class="section-card" id="production">
        <h2 class="section-title">
            <i class="fas fa-rocket"></i>
            <span class="zh">7. 生产部署</span>
            <span class="en">7. Production Deployment</span>
        </h2>
        
        <h4><span class="zh">方式一：直接运行</span><span class="en">Option 1: Direct Run</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># 前台运行
python3 cgminer_collector.py

# 后台运行
nohup python3 cgminer_collector.py > collector.log 2>&1 &</pre>
        </div>
        
        <h4 class="mt-3"><span class="zh">方式二：Systemd 服务（推荐）</span><span class="en">Option 2: Systemd Service (Recommended)</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># 创建服务文件
sudo nano /etc/systemd/system/hashinsight-collector.service</pre>
        </div>
        
        <p class="zh">粘贴以下内容：</p>
        <p class="en">Paste the following:</p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>[Unit]
Description=HashInsight Edge Collector
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/edge_collector
ExecStart=/usr/bin/python3 cgminer_collector.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target</pre>
        </div>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># 启用并启动服务
sudo systemctl daemon-reload
sudo systemctl enable hashinsight-collector
sudo systemctl start hashinsight-collector

# 查看状态
sudo systemctl status hashinsight-collector

# 查看日志
sudo journalctl -u hashinsight-collector -f</pre>
        </div>
        
        <h4 class="mt-3"><span class="zh">方式三：Docker 部署</span><span class="en">Option 3: Docker Deployment</span></h4>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>docker build -t hashinsight-collector .
docker run -d --name collector \
  -v $(pwd)/collector_config.json:/app/collector_config.json \
  -v $(pwd)/cache:/app/cache \
  --restart=always \
  hashinsight-collector</pre>
        </div>
    </div>
    
    <!-- Section 8: Troubleshooting -->
    <div class="section-card" id="troubleshooting">
        <h2 class="section-title">
            <i class="fas fa-wrench"></i>
            <span class="zh">8. 故障排查</span>
            <span class="en">8. Troubleshooting</span>
        </h2>
        
        <h4><span class="zh">矿机连接失败</span><span class="en">Miner Connection Failed</span></h4>
        <div class="code-block">
<pre># 检查矿机API是否开启
telnet 192.168.1.100 4028

# 检查防火墙
iptables -L -n | grep 4028

# 测试网络连通性
ping 192.168.1.100</pre>
        </div>
        
        <h4 class="mt-3"><span class="zh">上传失败</span><span class="en">Upload Failed</span></h4>
        <table class="data-table">
            <thead>
                <tr>
                    <th><span class="zh">问题</span><span class="en">Issue</span></th>
                    <th><span class="zh">解决方案</span><span class="en">Solution</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>401 Unauthorized</td>
                    <td><span class="zh">检查 API 密钥是否正确</span><span class="en">Check API key is correct</span></td>
                </tr>
                <tr>
                    <td>Connection refused</td>
                    <td><span class="zh">检查网络是否可访问互联网</span><span class="en">Check internet connectivity</span></td>
                </tr>
                <tr>
                    <td>SSL Error</td>
                    <td><span class="zh">更新系统 CA 证书</span><span class="en">Update system CA certificates</span></td>
                </tr>
                <tr>
                    <td>Timeout</td>
                    <td><span class="zh">检查代理设置或防火墙</span><span class="en">Check proxy settings or firewall</span></td>
                </tr>
            </tbody>
        </table>
        
        <h4 class="mt-3"><span class="zh">离线缓存</span><span class="en">Offline Cache</span></h4>
        <p class="zh">断网时数据会缓存到 <code>./cache/</code> 目录，恢复连接后自动上传</p>
        <p class="en">Data is cached to <code>./cache/</code> during network outage, auto-uploaded when connection resumes</p>
    </div>
    
    <!-- Section 9: Data -->
    <div class="section-card" id="data">
        <h2 class="section-title">
            <i class="fas fa-database"></i>
            <span class="zh">9. 采集数据说明</span>
            <span class="en">9. Collected Data</span>
        </h2>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th><span class="zh">数据项</span><span class="en">Field</span></th>
                    <th><span class="zh">说明</span><span class="en">Description</span></th>
                    <th><span class="zh">单位</span><span class="en">Unit</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>hashrate_ghs</code></td>
                    <td><span class="zh">平均算力</span><span class="en">Average Hashrate</span></td>
                    <td>GH/s</td>
                </tr>
                <tr>
                    <td><code>hashrate_5s_ghs</code></td>
                    <td><span class="zh">5秒实时算力</span><span class="en">5s Real-time Hashrate</span></td>
                    <td>GH/s</td>
                </tr>
                <tr>
                    <td><code>temperature_avg</code></td>
                    <td><span class="zh">平均温度</span><span class="en">Average Temperature</span></td>
                    <td>°C</td>
                </tr>
                <tr>
                    <td><code>temperature_max</code></td>
                    <td><span class="zh">最高温度</span><span class="en">Maximum Temperature</span></td>
                    <td>°C</td>
                </tr>
                <tr>
                    <td><code>fan_speeds</code></td>
                    <td><span class="zh">风扇转速数组</span><span class="en">Fan Speeds Array</span></td>
                    <td>RPM</td>
                </tr>
                <tr>
                    <td><code>frequency_avg</code></td>
                    <td><span class="zh">平均频率</span><span class="en">Average Frequency</span></td>
                    <td>MHz</td>
                </tr>
                <tr>
                    <td><code>accepted_shares</code></td>
                    <td><span class="zh">接受份额</span><span class="en">Accepted Shares</span></td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><code>rejected_shares</code></td>
                    <td><span class="zh">拒绝份额</span><span class="en">Rejected Shares</span></td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><code>hardware_errors</code></td>
                    <td><span class="zh">硬件错误</span><span class="en">Hardware Errors</span></td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><code>uptime_seconds</code></td>
                    <td><span class="zh">运行时间</span><span class="en">Uptime</span></td>
                    <td>s</td>
                </tr>
                <tr>
                    <td><code>pool_url</code></td>
                    <td><span class="zh">矿池地址</span><span class="en">Pool URL</span></td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><code>worker_name</code></td>
                    <td><span class="zh">矿工名称</span><span class="en">Worker Name</span></td>
                    <td>-</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- Support -->
    <div class="section-card" style="text-align: center;">
        <h3 style="color: #f7931a;">
            <i class="fas fa-headset me-2"></i>
            <span class="zh">技术支持</span>
            <span class="en">Technical Support</span>
        </h3>
        <p class="text-muted">
            <span class="zh">如有问题，请联系技术支持团队</span>
            <span class="en">For assistance, please contact our support team</span>
        </p>
        <p>
            <i class="fas fa-envelope me-2"></i>
            support@hashinsight.net
        </p>
    </div>
</div>

<script>
function setLang(lang) {
    document.body.classList.remove('lang-zh', 'lang-en');
    document.body.classList.add('lang-' + lang);
    
    document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector('.lang-btn[onclick="setLang(\'' + lang + '\')"]').classList.add('active');
}

function copyCode(btn) {
    const codeBlock = btn.parentElement.querySelector('pre');
    const text = codeBlock.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
        btn.textContent = 'Copied!';
        setTimeout(() => btn.textContent = 'Copy', 2000);
    });
}
</script>
{% endblock %}
