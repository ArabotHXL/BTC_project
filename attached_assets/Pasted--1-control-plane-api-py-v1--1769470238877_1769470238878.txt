一、收敛与包装（不改大逻辑，只提升可用性）
1) 命令体系收敛：以 control_plane_api.py (v1) 为权威

你现在的问题本质：
同一个“远程控制”能力，存在两套/多套协议与入口（remote_control_api.py、control_plane_api.py、legacy adapter），长期会导致：

UI/Edge 不确定该打哪个 API

日志/审计不统一（谁下发了什么命令、结果是什么）

幂等/并发/限速策略散落，越做越乱

收敛是什么意思：
把 “命令的唯一真相” 固定到 v1 Control Plane：

所有命令都必须走同一条路径（创建→审批→派发→ACK→结果落库）

所有权限（RBAC/ABAC）、审计、并发控制、幂等规则都在 v1

remote_control_api.py 怎么处理：

逐步变成“兼容层”：只做 转发/翻译（把旧格式映射到 v1），不再新增逻辑

加“弃用提示”：返回 header / message 告诉客户端迁移；到你写的生命周期（2026-06-01）后直接禁用或只保留只读

做完的样子（验收）：

Edge 只需要实现 一种 poll/ack 协议

UI 只对接 一种命令查询与执行

任何命令都能在一个地方追踪：状态流转 + 执行结果 + 操作人 + 证据包

2) 单一数据真相（Telemetry）：明确 live / history / raw_24h 边界

你现在的问题本质：
hosting、collector、TS service 可能各自有“取数口径”，会出现：
同一台矿机在不同页面显示不同 hashrate/状态（不是 bug 也会像 bug）。

三层数据的正确定位（建议口径）：

raw_24h（原始 24h）

含义：原始、最全、量最大（追溯/排障用）

用途：故障取证、模型训练、核对采集异常

特点：写多读少，保留短周期即可

live（最新快照）

含义：每台矿机“当前最新状态”一条记录（UI 秒开）

用途：列表、总览、地图、站点健康、实时告警判断的输入

特点：读多写多，但每台只保留最新一条

history（历史趋势/降采样）

含义：按分钟/5分钟/小时聚合的时间序列（用于趋势、对比、基线）

用途：折线图、异常检测、MTTR/可用率统计

特点：读多，存储更经济，保留更久（30/90/365天）

“单一真相”是什么意思：

写入路径统一：collector 只负责写 raw → 后台任务/流水线生成 live & history

读取口径统一：UI 与其它服务只通过同一套查询 API/同一套字段定义

字段定义稳定：hashrate 是 5min avg 还是 instant、reject 是 pct 还是 count，都要固定并写进 API contract

做完的样子（验收）：

“总览”“矿机详情”“告警解释”三处数据一致

任何指标都能回答：它来自 live 还是 history，窗口多长、聚合方式是什么

3) 把“占位功能”显式产品化（Coming Soon + feature_disabled）

你现在的问题本质：
占位 API 返回模拟数据，会造成：

用户以为功能已上线 → 信任被透支

你自己也难以判断“真实使用情况”（因为看起来有数据）

显式产品化怎么做：

UI：按钮/页面显示 Coming Soon，并说明“需要什么条件才能开通”（例如 Enterprise、需要对接交易所、需要链上钱包等）

API：统一返回结构化错误，例如

feature_disabled（功能未开通/未上线）

reason（为何不可用）

next_step（如何申请/何时上线/替代路径）

商业化：加“加入 waitlist / 联系销售 / 申请内测”

做完的样子（验收）：

任何“未完成能力”都不会输出假数据

客户体验是清晰可预期的，而不是“点了但不确定是真是假”

4) 把 AI 嵌入闭环流程（告警→诊断→建议→审批→执行→审计→复盘）

你现在的问题本质：
做一个聊天框很容易，但它往往停留在“解释”，不能推动结果；真正运营效率提升来自闭环。

闭环每一段的含义：

告警（Detect）：系统发现异常并标准化（severity/scope/symptom）

诊断（Diagnose）：AI 输出“最可能原因 + 证据”

建议（Recommend）：AI 输出“可执行动作 + 风险/收益/优先级”

审批（Approve）：人类确认（或满足某些安全条件自动批准）

执行（Act）：通过 v1 control plane 下发命令

审计（Audit）：谁批准/谁下发/设备回执/结果状态，全部可追踪

复盘（Learn）：这次建议是否有效？误报吗？动作导致副作用吗？用于规则与模型迭代

做完的样子（验收）：

AI 的输出不是“文字建议”，而是能直接变成按钮与工单字段的结构化结果

每次 AI 建议都能关联：输入证据包→输出建议→审批记录→执行结果→最终收益/恢复情况