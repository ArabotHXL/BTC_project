[
  {
    "signature_id": "power_no_output_or_shutdown",
    "title": "整机不上电/PSU无输出/频繁掉电重启",
    "category": "power",
    "severity": "critical",
    "priority": 1,
    "evidence": {
      "log_keywords": [
        "no output",
        "power off",
        "shutdown",
        "AC fail",
        "brownout",
        "protect",
        "ERROR_POWER_LOST",
        "Sweep error string = V:1"
      ],
      "log_regex": [
        "(?i)(no\\s*output|power\\s*off|shut\\s*down|ac\\s*fail|brownout|protect)",
        "(?i)(ERROR_POWER_LOST|Sweep\\s*error\\s*string\\s*=\\s*V:1)"
      ],
      "metric_rules": [
        "uptime_sec < 300 AND reboot_count_1h >= 2",
        "avg_hashrate_12h == 0"
      ],
      "codes": [
        "ERROR_POWER_LOST",
        "V:1",
        "ERROR_POWER_LOST: power voltage rise or drop",
        "ERROR_POWER_LOST: power voltage abnormity, pls check!",
        "ERROR_POWER_LOST: power status error!",
        "ERROR_POWER_LOST: power voltage read failed, pls check!",
        "Sweep error string = V:1"
      ],
      "notes": "优先排查外部供电/线缆/铜排螺丝→PSU→最小系统定位。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "iceriver_ks_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_power_psu_no_output_or_protect",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "whatsminer_error_codes_pdf_20210930",
      "bitmain_miners_restart_tips"
    ]
  },
  {
    "signature_id": "power_input_undervoltage",
    "title": "输入欠压/低电压保护",
    "category": "power",
    "severity": "critical",
    "priority": 2,
    "evidence": {
      "log_keywords": [
        "undervoltage",
        "input voltage is low",
        "low voltage"
      ],
      "log_regex": [
        "(?i)(undervoltage|input\\s*voltage\\s*is\\s*low|low\\s*voltage)"
      ],
      "metric_rules": [
        "input_voltage_v < 200"
      ],
      "codes": [
        "206",
        "250",
        "251",
        "271"
      ],
      "notes": "电压不足会导致PSU保护或掉算力。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_power_psu_no_output_or_protect",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "signature_id": "power_overcurrent_or_overpower",
    "title": "PSU过流/过功率保护",
    "category": "power",
    "severity": "critical",
    "priority": 3,
    "evidence": {
      "log_keywords": [
        "overcurrent",
        "over power",
        "power too high"
      ],
      "log_regex": [
        "(?i)(overcurrent|over\\s*power|power\\s*too\\s*high)"
      ],
      "metric_rules": [
        "psu_power_w > psu_rated_w * 0.98"
      ],
      "codes": [
        "236",
        "237",
        "246",
        "247",
        "255",
        "256",
        "268",
        "269",
        "2273"
      ],
      "notes": "检查铜排/接插件温升、短路、异常负载。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_power_psu_no_output_or_protect",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "signature_id": "power_psu_fan_error",
    "title": "PSU风扇错误/风扇告警",
    "category": "power",
    "severity": "critical",
    "priority": 4,
    "evidence": {
      "log_keywords": [
        "Power Fan Error",
        "power fan warning",
        "fan error"
      ],
      "log_regex": [
        "(?i)(power\\s*fan\\s*(error|warning)|psu\\s*fan\\s*(error|fail))"
      ],
      "metric_rules": [],
      "codes": [
        "253",
        "254",
        "274"
      ],
      "notes": "PSU散热异常会触发保护。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_power_psu_no_output_or_protect",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "signature_id": "no_ip_or_unreachable",
    "title": "无IP/无法访问Web/无法升级",
    "category": "network",
    "severity": "critical",
    "priority": 10,
    "evidence": {
      "log_keywords": [
        "no ip",
        "dhcp",
        "link down",
        "unreachable",
        "upgrade failed"
      ],
      "log_regex": [
        "(?i)(no\\s*ip|dhcp|link\\s*down|unreachable|upgrade\\s*failed)"
      ],
      "metric_rules": [
        "ip_address == null OR web_reachable == false"
      ],
      "codes": [],
      "notes": "优先排DHCP/MAC绑定/线缆/交换机→浏览器缓存→刷机/控制板。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "iceriver_ks_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_network_no_ip_unreachable",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": [
      "bitmain_cant_find_ip",
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "signature_id": "web_login_or_ui_bug",
    "title": "Web后台异常/页面打不开/兼容性问题",
    "category": "network",
    "severity": "warn",
    "priority": 20,
    "evidence": {
      "log_keywords": [
        "can't access",
        "backstage",
        "login",
        "cache"
      ],
      "log_regex": [
        "(?i)(can'?t\\s*access|backstage|browser|cache)"
      ],
      "metric_rules": [
        "web_reachable == false AND ip_address != null"
      ],
      "codes": [],
      "notes": "通常与浏览器缓存/协议(http/https)/重置有关。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_network_no_ip_unreachable",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": [
      "bitmain_cant_find_ip"
    ]
  },
  {
    "signature_id": "pool_connect_failed",
    "title": "矿池连接失败/超时/拒绝连接",
    "category": "pool",
    "severity": "critical",
    "priority": 30,
    "evidence": {
      "log_keywords": [
        "pool connect failed",
        "connection failed",
        "stratum",
        "timeout",
        "refused",
        "stratum connection timeout",
        "retry after 30 seconds failures"
      ],
      "log_regex": [
        "(?i)(pool.*(fail|timeout)|connection\\s*(failed|refused)|stratum.*(fail|timeout))",
        "(?i)(stratum\\s*connection\\s*timeout|retry\\s*after\\s*30\\s*seconds\\s*failures)"
      ],
      "metric_rules": [
        "pool_disconnect_count_1h >= 3 OR avg_hashrate_12h == 0"
      ],
      "codes": [
        "stratum connection timeout",
        "...retry after 30 seconds failures 1"
      ],
      "notes": "先核对配置与端口，再排网络/DNS/出口端口限制。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "iceriver_ks_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_pool_auth_disconnect",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_pool_failover",
    "sources": [
      "bitmain_cant_connect_pool",
      "bitmain_l7_diagnostic_logs"
    ]
  },
  {
    "signature_id": "pool_auth_failed",
    "title": "矿池授权失败/worker不正确/未授权",
    "category": "pool",
    "severity": "critical",
    "priority": 31,
    "evidence": {
      "log_keywords": [
        "not authorized",
        "authorize",
        "invalid worker",
        "unauthorized"
      ],
      "log_regex": [
        "(?i)(not\\s*authorized|authori[sz]e.*(fail|error)|invalid\\s*worker|unauthori[sz]ed)"
      ],
      "metric_rules": [
        "avg_hashrate_12h == 0 AND pool_disconnect_count_1h >= 1"
      ],
      "codes": [],
      "notes": "常见原因：worker/密码含空格、大小写、矿池端口/协议不匹配。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_pool_auth_disconnect",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_pool_failover",
    "sources": [
      "bitmain_cant_connect_pool"
    ]
  },
  {
    "signature_id": "pool_high_reject_rate",
    "title": "拒绝率高/无效份额/时间差导致 stale",
    "category": "pool",
    "severity": "warn",
    "priority": 40,
    "evidence": {
      "log_keywords": [
        "rejected",
        "stale",
        "invalid share",
        "low difficulty share"
      ],
      "log_regex": [
        "(?i)(rejected|stale|invalid\\s*share|low\\s*difficulty\\s*share)"
      ],
      "metric_rules": [
        "reject_rate > 0.03 OR stale_rate > 0.02"
      ],
      "codes": [],
      "notes": "优先看网络延迟与NTP同步，再看超频导致错误率。"
    },
    "applies_to": [
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_hashrate_low_fluctuation",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": []
  },
  {
    "signature_id": "dns_resolution_fail",
    "title": "DNS解析失败/域名无法解析",
    "category": "network",
    "severity": "warn",
    "priority": 41,
    "evidence": {
      "log_keywords": [
        "dns",
        "resolve",
        "name lookup",
        "temporary failure in name resolution"
      ],
      "log_regex": [
        "(?i)(dns|resolve|name\\s*lookup|temporary\\s*failure\\s*in\\s*name\\s*resolution)"
      ],
      "metric_rules": [
        "dns_fail_count >= 3"
      ],
      "codes": [],
      "notes": "DNS问题会表现为矿池连接失败。"
    },
    "applies_to": [
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_pool_auth_disconnect",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": []
  },
  {
    "signature_id": "firmware_upgrade_failed",
    "title": "固件升级失败/刷机失败/固件不匹配",
    "category": "firmware",
    "severity": "critical",
    "priority": 50,
    "evidence": {
      "log_keywords": [
        "upgrade failed",
        "firmware exception",
        "firmware does not match",
        "flash"
      ],
      "log_regex": [
        "(?i)(upgrade\\s*failed|firmware\\s*exception|does\\s*not\\s*match|flash)"
      ],
      "metric_rules": [
        "reboot_count_1h >= 2 AND avg_hashrate_12h == 0"
      ],
      "codes": [],
      "notes": "Bitmain官方将固件不匹配/文件损坏归为常见原因。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "canaan_avalon_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_firmware_upgrade_failed",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "signature_id": "config_error_or_factory_reset_needed",
    "title": "配置错误/需要恢复出厂",
    "category": "firmware",
    "severity": "warn",
    "priority": 55,
    "evidence": {
      "log_keywords": [
        "configuration error",
        "factory reset",
        "restore"
      ],
      "log_regex": [
        "(?i)(config(uration)?\\s*error|factory\\s*reset|restore)"
      ],
      "metric_rules": [
        "avg_hashrate_12h == 0 AND web_reachable == true"
      ],
      "codes": [],
      "notes": "配置错误会导致无法连接矿池或异常运行。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_firmware_upgrade_failed",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_pool_failover",
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "bitmain_cant_connect_pool"
    ]
  },
  {
    "signature_id": "thermal_overheat_protection",
    "title": "过温保护触发/环境温度过高",
    "category": "thermal",
    "severity": "critical",
    "priority": 60,
    "evidence": {
      "log_keywords": [
        "overheat",
        "temperature too high",
        "temperature protecting",
        "too hot"
      ],
      "log_regex": [
        "(?i)(overheat|temperature\\s*(too\\s*high|protecting|protect)|too\\s*hot)"
      ],
      "metric_rules": [
        "chip_temp_c >= 90 OR pcb_temp_c >= 80 OR exhaust_temp_c >= 45"
      ],
      "codes": [
        "350",
        "351",
        "352",
        "64"
      ],
      "notes": "官方与手册均强调过温保护与风扇/环境检查。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "iceriver_ks_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "whatsminer_error_codes_pdf_20210930",
      "canaan_avalon_troubleshooting_repair_guide_2018"
    ]
  },
  {
    "signature_id": "thermal_fan_lost_or_speed_low",
    "title": "风扇丢失/转速低/Fatal fan lost",
    "category": "thermal",
    "severity": "critical",
    "priority": 61,
    "evidence": {
      "log_keywords": [
        "Fan lost",
        "Fan speed low",
        "some Fan lost",
        "fan abnormal"
      ],
      "log_regex": [
        "(?i)(fan\\s*(lost|speed\\s*low|abnormal)|some\\s*fan\\s*lost)"
      ],
      "metric_rules": [
        "fan_lost_count >= 1 OR fans_rpm < 2000"
      ],
      "codes": [
        "ERROR_FAN_LOST"
      ],
      "notes": "Bitmain官方提示 kernel log 出现 Fan lost 需检查风扇。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "iceriver_ks_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "bitmain_hashrate_zero",
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "signature_id": "thermal_sensor_read_fail",
    "title": "温度传感器读取失败/通信异常",
    "category": "thermal",
    "severity": "critical",
    "priority": 62,
    "evidence": {
      "log_keywords": [
        "Read Temp Sensor Failed",
        "temperature reading error",
        "sensor communication error"
      ],
      "log_regex": [
        "(?i)(read\\s*temp\\s*sensor\\s*failed|temperature\\s*reading\\s*error|sensor\\s*communication\\s*error)"
      ],
      "metric_rules": [
        "chip_temp_c == null OR pcb_temp_c == null"
      ],
      "codes": [
        "320",
        "321",
        "322",
        "329",
        "4096",
        "Read Temp Sensor Failed"
      ],
      "notes": "温度读取异常可能导致保护停机。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "whatsminer_error_codes_pdf_20210930",
      "canaan_avalon_troubleshooting_repair_guide_2018"
    ]
  },
  {
    "signature_id": "thermal_water_flow_issue",
    "title": "水冷流量不足/水温过高/气堵风险",
    "category": "thermal",
    "severity": "critical",
    "priority": 63,
    "evidence": {
      "log_keywords": [
        "flow",
        "pump",
        "water temp",
        "leak"
      ],
      "log_regex": [
        "(?i)(flow\\s*(low|error)|pump\\s*(fail|error)|water\\s*temp\\s*(high|too\\s*high)|leak)"
      ],
      "metric_rules": [
        "water_flow_lpm < 5 OR water_temp_c > 40"
      ],
      "codes": [],
      "notes": "水冷需把水温/流量与功率联动，异常时快速降功率。"
    },
    "applies_to": [
      "antminer_s21_family",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": []
  },
  {
    "signature_id": "missing_chain_or_find_x_asic",
    "title": "缺链/找不全芯片（missing chain / find X asic）",
    "category": "hash_board",
    "severity": "critical",
    "priority": 70,
    "evidence": {
      "log_keywords": [
        "missing chain",
        "find",
        "asic",
        "chip",
        "0 asic",
        "not found"
      ],
      "log_regex": [
        "(?i)(missing\\s*chain|find\\s*\\d+\\s*asic|chain\\s*\\d+.*only\\s*find|0\\s*asic|not\\s*found)"
      ],
      "metric_rules": [
        "chain_ok_count < chain_total OR asic_found < asic_expected"
      ],
      "codes": [
        "530",
        "Chain X only found Y ASICs"
      ],
      "notes": "先定位 chain/板位，再做互换与单板测试。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "microbt_whatsminer_generic",
      "canaan_avalon_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_missing_chain_asic",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "whatsminer_error_codes_pdf_20210930",
      "zeus_s21_xp_hashboard_repair"
    ]
  },
  {
    "signature_id": "eeprom_error_hashboard",
    "title": "EEPROM 检测/解析错误（哈希板）",
    "category": "hash_board",
    "severity": "critical",
    "priority": 71,
    "evidence": {
      "log_keywords": [
        "eeprom error",
        "detect eeprom error",
        "parser eeprom error"
      ],
      "log_regex": [
        "(?i)(eeprom.*(error|fail)|detect\\s*eeprom|parser\\s*eeprom)"
      ],
      "metric_rules": [],
      "codes": [
        "410",
        "411",
        "412",
        "420",
        "421",
        "422"
      ],
      "notes": "多为板级器件或内容异常，刷机不一定能解决。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_missing_chain_asic",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "signature_id": "hw_error_rate_high",
    "title": "硬件错误率(HW/MH)过高",
    "category": "hash_board",
    "severity": "warn",
    "priority": 80,
    "evidence": {
      "log_keywords": [
        "HW",
        "MH",
        "hardware error"
      ],
      "log_regex": [
        "(?i)(\\bHW\\b|\\bMH\\b|hardware\\s*error)"
      ],
      "metric_rules": [
        "hw_error_rate > 0.02"
      ],
      "codes": [],
      "notes": "Canaan技术指导提到 HW error 指标阈值。"
    },
    "applies_to": [
      "canaan_avalon_generic",
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_hashrate_low_fluctuation",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "canaan_miner_log_tech_guidance"
    ]
  },
  {
    "signature_id": "pll_config_invalid",
    "title": "PLL 配置异常/锁相失败（Avalon/部分矿机）",
    "category": "hash_board",
    "severity": "warn",
    "priority": 81,
    "evidence": {
      "log_keywords": [
        "PLL",
        "invalid pll",
        "pll check failed"
      ],
      "log_regex": [
        "(?i)(pll|invalid\\s*pll|pll\\s*check\\s*failed)"
      ],
      "metric_rules": [],
      "codes": [
        "65536"
      ],
      "notes": "Avalon repair guide: invalid PLL value 可通过重启或更换板解决。"
    },
    "applies_to": [
      "canaan_avalon_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_missing_chain_asic",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "canaan_avalon_troubleshooting_repair_guide_2018"
    ]
  },
  {
    "signature_id": "control_board_temp_sensor_fail",
    "title": "控制板温度传感器通信错误",
    "category": "control_board",
    "severity": "critical",
    "priority": 90,
    "evidence": {
      "log_keywords": [
        "control board temperature sensor communication error"
      ],
      "log_regex": [
        "(?i)(control\\s*board.*temperature.*communication\\s*error)"
      ],
      "metric_rules": [],
      "codes": [
        "329"
      ],
      "notes": "可能导致温控失效或保护。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_esd_power_safety",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "signature_id": "control_board_config_error",
    "title": "控制板配置错误/需要刷机恢复",
    "category": "control_board",
    "severity": "warn",
    "priority": 95,
    "evidence": {
      "log_keywords": [
        "control board configuration error"
      ],
      "log_regex": [
        "(?i)(control\\s*board.*configuration\\s*error)"
      ],
      "metric_rules": [],
      "codes": [],
      "notes": "Bitmain建议使用SD卡刷机恢复控制板程序。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_firmware_upgrade_failed",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_pool_failover",
    "sources": [
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "signature_id": "ntp_unsync_or_time_drift",
    "title": "NTP不同步/时间漂移",
    "category": "time",
    "severity": "warn",
    "priority": 110,
    "evidence": {
      "log_keywords": [
        "ntp",
        "time sync",
        "time drift",
        "clock"
      ],
      "log_regex": [
        "(?i)(ntp|time\\s*sync|time\\s*drift|clock\\s*offset)"
      ],
      "metric_rules": [
        "abs(ntp_offset_ms) > 2000"
      ],
      "codes": [],
      "notes": "手册指出矿机运行时间与算力统计依赖 NTP。"
    },
    "applies_to": [
      "microbt_whatsminer_generic",
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_time_ntp_sync",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": [
      "whatsminer_product_manuals"
    ]
  },
  {
    "signature_id": "disk_full_or_log_overflow",
    "title": "磁盘满/日志过大导致服务异常",
    "category": "storage",
    "severity": "warn",
    "priority": 120,
    "evidence": {
      "log_keywords": [
        "no space left",
        "disk full",
        "filesystem full"
      ],
      "log_regex": [
        "(?i)(no\\s*space\\s*left|disk\\s*full|filesystem\\s*full)"
      ],
      "metric_rules": [
        "disk_free_mb < 200"
      ],
      "codes": [],
      "notes": "适用于自定义固件/边缘采集器等场景；App侧应监控。"
    },
    "applies_to": [
      "generic_asic_miner",
      "gpu_rig_generic"
    ],
    "playbook_id": "pb_storage_disk_full",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_downclock_powercap",
    "sources": []
  },
  {
    "signature_id": "humidity_dust_corrosion_risk",
    "title": "粉尘/湿度导致故障风险升高",
    "category": "environment",
    "severity": "warn",
    "priority": 200,
    "evidence": {
      "log_keywords": [
        "dust",
        "corrosion",
        "humidity"
      ],
      "log_regex": [
        "(?i)(dust|corrosion|humidity)"
      ],
      "metric_rules": [
        "humidity_pct > 70"
      ],
      "codes": [],
      "notes": "环境因素通常是复发根因，需纳入巡检与策略。"
    },
    "applies_to": [
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": []
  },
  {
    "signature_id": "tpl_future_001",
    "title": "[模板] GPU: 驱动崩溃/显卡掉卡",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_002",
    "title": "[模板] GPU: 过度超频导致 invalid share",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_003",
    "title": "[模板] GPU: PCIe 链路/供电问题",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_004",
    "title": "[模板] 浸没: 介质污染/粘度变化",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_005",
    "title": "[模板] 网络: 端口被封/出口限速",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_006",
    "title": "[模板] 固件: 证书过期/HTTPS错误",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_007",
    "title": "[模板] 控制板: 存储损坏/无法启动",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_008",
    "title": "[模板] 哈希板: 单域欠压/过流",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_009",
    "title": "[模板] 哈希板: 温度传感器坏",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "tpl_future_010",
    "title": "[模板] 哈希板: PIC/MCU异常",
    "category": "unknown",
    "severity": "info",
    "priority": 999,
    "evidence": {
      "log_keywords": [],
      "log_regex": [],
      "metric_rules": [],
      "codes": [],
      "notes": "模板：需要补充具体日志/指标/机型映射后启用。"
    },
    "applies_to": [
      "template_only"
    ],
    "playbook_id": "",
    "prevention_id": "",
    "tuning_id": "",
    "sources": []
  },
  {
    "signature_id": "thermal_temp_too_low",
    "title": "低温保护/温度过低（P:2 / ERROR_TEMP_TOO_LOW）",
    "category": "environment",
    "severity": "critical",
    "priority": 58,
    "evidence": {
      "log_keywords": [
        "ERROR_TEMP_TOO_LOW",
        "temp too low",
        "Sweep error string = P:2"
      ],
      "log_regex": [
        "(?i)(ERROR_TEMP_TOO_LOW|temp\\s*too\\s*low|Sweep\\s*error\\s*string\\s*=\\s*P:2)"
      ],
      "metric_rules": [],
      "codes": [
        "Sweep error string = P:2",
        "ERROR_TEMP_TOO_LOW: temp too low!"
      ],
      "notes": "低温情况下启动/重启可能损伤设备；先升温再处理。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_thermal_overheat_fan",
    "prevention_id": "prev_thermal_hygiene",
    "tuning_id": "tune_thermal_policy",
    "sources": [
      "bitmain_miners_restart_tips"
    ]
  },
  {
    "signature_id": "control_board_soc_init_failed",
    "title": "控制板/SoC 初始化失败（ERROR_SOC_INIT）",
    "category": "control_board",
    "severity": "critical",
    "priority": 57,
    "evidence": {
      "log_keywords": [
        "ERROR_SOC_INIT",
        "soc init failed"
      ],
      "log_regex": [
        "(?i)(ERROR_SOC_INIT|soc\\s*init\\s*failed)"
      ],
      "metric_rules": [],
      "codes": [
        "ERROR_SOC_INIT: soc init failed"
      ],
      "notes": "官方建议先排查短路风险；有短路禁止重启。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_firmware_upgrade_failed",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_downclock_powercap",
    "sources": [
      "bitmain_miners_restart_tips"
    ]
  },
  {
    "signature_id": "network_net_lost_poweroff",
    "title": "网络丢失过久导致断电保护（net lost poweroff）",
    "category": "network",
    "severity": "critical",
    "priority": 12,
    "evidence": {
      "log_keywords": [
        "net lost",
        "lost internet",
        "poweroff"
      ],
      "log_regex": [
        "(?i)(net\\s*lost|lost\\s*internet.*poweroff)"
      ],
      "metric_rules": [],
      "codes": [
        "level=fatal pid=* error=\"net lost\" msg=\"lost internet 1200 seconds > 20 minutes, poweroff.\""
      ],
      "notes": "长时间断网会触发保护；需要网络侧稳定性治理。"
    },
    "applies_to": [
      "bitmain_antminer_generic",
      "generic_asic_miner"
    ],
    "playbook_id": "pb_network_no_ip_unreachable",
    "prevention_id": "prev_config_firmware_ops",
    "tuning_id": "tune_ntp_dns_baseline",
    "sources": [
      "bitmain_l7_diagnostic_logs"
    ]
  }
]