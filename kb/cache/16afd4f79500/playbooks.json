[
  {
    "playbook_id": "pb_power_psu_no_output_or_protect",
    "title": "供电/PSU：无输出、保护模式、掉电重启",
    "goal": "快速区分外部供电/线缆/PSU 与矿机内部短路或过载。",
    "safety": [
      "高压危险：任何拆PSU/测量前必须断电并等待放电；不熟悉开关电源维修请送修。",
      "防静电（ESD）；避免金属工具短路。"
    ],
    "steps": [
      "记录：PSU 指示灯/风扇、是否异味、重启频率、日志中的 AC fail / power off / protect 等关键词。",
      "外部：确认插座/PDU 电压正常；更换电源线与插座（A/B）。",
      "线束：检查铜排螺丝、接插件是否松动/烧蚀；重新紧固或替换线束。",
      "交叉：互换 PSU（同型号）验证是否随 PSU 迁移。",
      "若仍异常：最小系统定位——断开全部哈希板，仅保留控制板+网络上电，判断是否为内部短路/控制板异常。",
      "确认 PSU 故障：更换或送修；确认内部短路：进入控制板/哈希板分段排查。"
    ],
    "escalation": [
      "需要PSU板级维修或内部短路定位到板级器件时升级至维修中心。"
    ],
    "verification": [
      "稳定运行 30–60 分钟无掉电；输出功率与温升正常。"
    ],
    "artifacts": [
      "PSU 型号/序列号照片",
      "铜排/接插件照片",
      "A/B 互换记录"
    ],
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "playbook_id": "pb_network_no_ip_unreachable",
    "title": "网络：无 IP、Web 不可达、IP 已知但进不去",
    "goal": "把问题拆为 DHCP/交换机/线缆 → 浏览器/缓存 → 控制板/固件。",
    "safety": [
      "拔插网线建议断电；避免在潮湿环境操作。"
    ],
    "steps": [
      "更换网线与交换机端口；确认交换机口灯与同网段设备正常。",
      "检查 DHCP 是否开启、是否 MAC 绑定/白名单导致分配失败；查看 DHCP 租约表。",
      "若“知道 IP 但进不去”：换浏览器/清缓存；确认使用 http 而非 https；必要时恢复出厂。",
      "若仍失败：按品牌手册进行 SD/TF 刷机或控制板重刷；怀疑控制板网口/固件损坏则更换/送修。"
    ],
    "escalation": [
      "需要控制板电压测量、网口器件维修或刷机失败时升级至维修中心。"
    ],
    "verification": [
      "稳定获得 IP；Web UI 可访问；可完成升级/配置；矿池连接正常。"
    ],
    "artifacts": [
      "交换机/DHCP 租约截图",
      "IP reporter/扫描结果",
      "升级/刷机日志"
    ],
    "sources": [
      "bitmain_cant_find_ip",
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "playbook_id": "pb_pool_auth_disconnect",
    "title": "矿池：无法连接/授权失败/频繁断连",
    "goal": "从配置错误 → 网络/DNS/NTP → 控制板异常逐层排除。",
    "safety": [
      "避免频繁重启全场；先在单机验证配置。"
    ],
    "steps": [
      "核对矿池 URL/端口/协议（stratum+tcp/ssl）、worker/密码是否含空格/全半角符号。",
      "切换备用矿池（failover）验证是否为矿池侧问题。",
      "排查 DNS 解析、网关出网、端口限制（矿场 LAN 防火墙/限流）。",
      "确认 NTP 时间正确（时间漂移可能导致统计异常或 TLS 失败）。",
      "若配置与网络都正常仍无法连接：按官方建议刷机/恢复出厂；必要时更换控制板。"
    ],
    "escalation": [
      "大面积无法连接：优先排查矿场网络出口与 DNS/NTP；单机问题再升级到控制板。"
    ],
    "verification": [
      "矿池侧算力恢复；拒绝率/断连率回到阈值内；failover 可正常工作。"
    ],
    "artifacts": [
      "矿池配置截图",
      "Ping/DNS/路由追踪结果",
      "矿池侧拒绝率截图"
    ],
    "sources": [
      "bitmain_cant_connect_pool"
    ]
  },
  {
    "playbook_id": "pb_firmware_upgrade_failed",
    "title": "固件：升级失败/固件不匹配/异常重启",
    "goal": "在不损坏设备前提下恢复到可用固件与稳定配置。",
    "safety": [
      "升级过程保证电源稳定；避免批量同时升级；保留回滚固件与配置备份。"
    ],
    "steps": [
      "确认固件与机型/控制板版本匹配；重新下载升级包并校验完整性（如提供校验值）。",
      "排查网络不稳定（丢包/断电）导致升级中断；换更稳定的链路重试。",
      "若 Web 升级失败：按官方教程使用 SD/TF 刷机方式恢复。",
      "升级后先加载默认/稳定 profile；逐步恢复个性化设置（矿池、频率、风扇策略）。"
    ],
    "escalation": [
      "刷机失败或设备无法启动：升级至维修中心（可能需要重刷存储或更换控制板）。"
    ],
    "verification": [
      "固件版本正确；运行 12h 稳定；配置可回滚。"
    ],
    "artifacts": [
      "升级包版本与校验记录",
      "升级日志/截图",
      "刷机步骤记录"
    ],
    "sources": [
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "playbook_id": "pb_thermal_overheat_fan",
    "title": "温控：过温保护/风扇丢失或转速低/温度传感器异常",
    "goal": "把过温按“环境→风道→风扇/水泵→散热接触→传感器/固件”顺序定位。",
    "safety": [
      "高温烫伤风险；停机降温后再拆机。",
      "未安装散热器/冷板的板级测试严禁长时间上电。"
    ],
    "steps": [
      "收集证据：进/出风温度、水温/流量（如有）、芯片/板温、风扇转速、告警码。",
      "环境与风道：清洁过滤网/风道，确保进风无遮挡；检查机房温湿度是否超标。",
      "风扇/水路：检查风扇是否掉速/异响/线缆松动；水冷检查泵与流量、是否气堵/泄漏。",
      "传感器：出现 Read Temp Sensor Failed / 温度读取错误时，优先检查线缆与传感器，再考虑刷机或板级维修。",
      "配置：临时降频/限功率验证稳定性，再逐步恢复。"
    ],
    "escalation": [
      "持续过温或单板温度异常：升级至维修中心（可能涉及导热/器件/芯片损伤）。"
    ],
    "verification": [
      "目标功率下 12h 稳定；不触发过温保护；风扇/泵工作正常。"
    ],
    "artifacts": [
      "温度/风扇曲线截图",
      "风道清洁前后照片",
      "告警日志片段"
    ],
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "bitmain_hashrate_zero",
      "whatsminer_error_codes_pdf_20210930"
    ]
  },
  {
    "playbook_id": "pb_hashrate_low_fluctuation",
    "title": "算力：持续低算力/波动/拒绝率高",
    "goal": "先排温控与缺链，再排矿池/网络，最后排固件与硬件退化。",
    "safety": [
      "避免长时间超频在不稳定状态运行（可能导致更严重损坏）。"
    ],
    "steps": [
      "确认口径：对比矿机侧 5m/1h/12h 与矿池侧算力；区分短期波动与持续低算力。",
      "先按温控 playbook 排查是否降频或过温。",
      "检查缺链/缺芯片/硬件错误率（HW/MH error）是否超阈值；若有进入哈希板诊断。",
      "排查网络延迟与矿池断连；启用备用矿池/切换线路验证。",
      "恢复默认/稳定 profile；逐步上调，记录触发点；必要时刷机后再验证。"
    ],
    "escalation": [
      "单链异常或 HW error 持续偏高：升级板级检修。"
    ],
    "verification": [
      "12h 平均算力达标；拒绝率、HW error 在阈值内。"
    ],
    "artifacts": [
      "矿池侧算力/拒绝率截图",
      "矿机侧日志与平均算力",
      "网络延迟测试"
    ],
    "sources": [
      "bitmain_antminer_failures_troubleshooting",
      "canaan_miner_log_tech_guidance"
    ]
  },
  {
    "playbook_id": "pb_missing_chain_asic",
    "title": "哈希板：缺链/找不全芯片/0 ASIC/EEPROM 异常",
    "goal": "从整机定位到具体链/板，再用单板测试与电气测量定位到电压域/芯片。",
    "safety": [
      "断电放电后拆装；注意大电流接插件发热与烧蚀。",
      "单板测试必须配套散热与治具；避免上电烧板。"
    ],
    "steps": [
      "根据日志定位异常 chain/board；映射到物理板位并检查信号线/供电线是否松动或烧蚀。",
      "互换验证：把疑似故障板与正常板互换位置，确认问题是否随板迁移（排除控制板端口）。",
      "单板测试（治具/PT）：确定缺失芯片范围（全无/少量/某域）。",
      "优先处理：短路、虚焊、异物、烧蚀器件；EEPROM/温度传感器错误优先查对应器件与供电。",
      "复测通过后回装整机，做老化测试。"
    ],
    "escalation": [
      "需要 BGA 换芯片、复杂信号测量、治具固件升级时升级至维修中心。"
    ],
    "verification": [
      "芯片数量识别完整；整机链路全正常；算力与温度稳定。"
    ],
    "artifacts": [
      "日志链路/ASIC 截图",
      "单板测试结果",
      "关键测点电压/阻抗记录"
    ],
    "sources": [
      "zeus_s21_xp_hashboard_repair",
      "whatsminer_error_codes_pdf_20210930",
      "bitmain_antminer_failures_troubleshooting"
    ]
  },
  {
    "playbook_id": "pb_time_ntp_sync",
    "title": "时间：NTP 不同步/时间漂移/统计异常",
    "goal": "保证矿机时间正确，减少算力统计偏差、断连与证书问题。",
    "safety": [
      "改动网络基线时先在单机验证，避免影响全场。"
    ],
    "steps": [
      "确认矿机时间与时区；检查是否启用 NTP；记录 offset。",
      "检查矿机网段 DNS/出网是否能访问 NTP server；必要时在局域网提供本地 NTP。",
      "重启 NTP 服务或重启矿机验证；观察算力统计是否恢复稳定。",
      "若时间反复漂移：排查网关/防火墙是否拦截 NTP(UDP/123)，以及控制板系统异常。"
    ],
    "escalation": [
      "持续无法同步且影响运行：升级到控制板/固件排查。"
    ],
    "verification": [
      "时间稳定；算力统计一致；不再出现相关告警。"
    ],
    "artifacts": [
      "时间/时区截图",
      "NTP server 配置",
      "网络抓包/端口检查（可选）"
    ],
    "sources": [
      "whatsminer_product_manuals"
    ]
  },
  {
    "playbook_id": "pb_storage_disk_full",
    "title": "存储：磁盘满/日志爆炸/系统不稳定",
    "goal": "避免因存储耗尽导致的重启、服务崩溃、升级失败。",
    "safety": [
      "清理前先导出关键日志；谨慎删除系统文件。"
    ],
    "steps": [
      "检查日志与可用空间；导出故障时间窗口日志用于 RCA。",
      "清理过旧日志/缓存；降低调试日志级别（如可配置）。",
      "若升级失败或服务异常：按固件恢复 playbook 做刷机/恢复出厂。",
      "建立日志轮转与容量告警（App 侧也要监控）。"
    ],
    "escalation": [
      "无法进入系统或反复崩溃：升级到刷机/更换控制板。"
    ],
    "verification": [
      "空间恢复到安全阈值；运行稳定；升级可完成。"
    ],
    "artifacts": [
      "空间占用截图",
      "日志目录列表",
      "清理前后对比"
    ],
    "sources": [
      "bitmain_antminer_failures_troubleshooting"
    ]
  }
]